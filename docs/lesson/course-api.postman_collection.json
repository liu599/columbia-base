{
  "info": {
    "_postman_id": "course-lesson-api-collection",
    "name": "Course Lesson API",
    "description": "课程产品详情接口 - 包含学生端和管理后台所有接口",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:8080",
      "type": "string"
    },
    {
      "key": "token",
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "Auth - 认证相关",
      "item": [
        {
          "name": "用户登录",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"account\": \"{{username}}\",\n  \"password\": \"{{password}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/user/login",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "user", "login"]
            },
            "description": "用户登录接口，获取 Bearer Token"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.collectionVariables.set('token', jsonData.data.token);",
                  "    pm.collectionVariables.set('userId', jsonData.data.userId);",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "用户注册",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"testuser\",\n  \"password\": \"Test@123456\",\n  \"phone\": \"13800138000\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/user/register",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "user", "register"]
            }
          }
        }
      ]
    },
    {
      "name": "Student - 学生端接口",
      "item": [
        {
          "name": "P0 - 激活课程",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"code\": \"COURSE2024\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/student/courses/{{courseId}}/activate",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "student", "courses", "{{courseId}}", "activate"]
            },
            "description": "使用激活码激活/兑换课程"
          }
        },
        {
          "name": "P0 - 获取课程详情及大纲",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/student/courses/{{courseId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "student", "courses", "{{courseId}}"]
            },
            "description": "获取课程基本信息和章节课时大纲目录"
          }
        },
        {
          "name": "P0 - 获取课时详细内容",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/student/lessons/{{lessonId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "student", "lessons", "{{lessonId}}"]
            },
            "description": "获取课时详细内容，包含防盗链的临时 URL 和安全配置"
          }
        },
        {
          "name": "P0 - 上报学习进度",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"status\": \"IN_PROGRESS\",\n  \"progressPayload\": {\n    \"currentTime\": 120,\n    \"duration\": 600\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/student/lessons/{{lessonId}}/progress",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "student", "lessons", "{{lessonId}}", "progress"]
            },
            "description": "上报学习进度，如视频播放时间、交互课进度等"
          }
        },
        {
          "name": "P0 - 提交作业",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"submissionPayload\": {\n    \"text_answer\": \"我的架构思路是...\",\n    \"file_urls\": [\"https://example.com/file.pdf\"]\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/student/assignments/{{lessonId}}/submit",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "student", "assignments", "{{lessonId}}", "submit"]
            },
            "description": "提交作业，支持文本答案和文件链接"
          }
        },
        {
          "name": "P1 - 我的课程列表",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/student/my-courses?current=1&pageSize=20",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "student", "my-courses"],
              "query": [
                {
                  "key": "current",
                  "value": "1"
                },
                {
                  "key": "pageSize",
                  "value": "20"
                }
              ]
            },
            "description": "获取用户已激活的课程列表和整体进度"
          }
        },
        {
          "name": "P1 - 查询作业状态",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/student/assignments/{{lessonId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "student", "assignments", "{{lessonId}}"]
            },
            "description": "查询某次作业的当前状态、得分及老师评语"
          }
        }
      ]
    },
    {
      "name": "Admin - 管理后台接口",
      "item": [
        {
          "name": "P0 - 创建/更新课程",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"id\": null,\n  \"title\": \"Java 架构师课程\",\n  \"description\": \"从入门到精通的 Java 架构师课程\",\n  \"status\": \"PUBLISHED\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/admin/courses",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "admin", "courses"]
            },
            "description": "创建或更新课程基础元数据"
          }
        },
        {
          "name": "P0 - 创建/更新章节",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"id\": null,\n  \"courseId\": {{courseId}},\n  \"title\": \"第一章：Java 基础\",\n  \"sortOrder\": 1\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/admin/chapters",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "admin", "chapters"]
            },
            "description": "管理课程的大纲结构"
          }
        },
        {
          "name": "P0 - 创建/更新课时",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"id\": null,\n  \"chapterId\": {{chapterId}},\n  \"title\": \"第一节：Hello World\",\n  \"itemType\": \"VIDEO\",\n  \"isRequired\": true,\n  \"sortOrder\": 1,\n  \"contentPayload\": {\n    \"fileUrl\": \"https://example.com/video.mp4\",\n    \"duration\": 600,\n    \"thumbnail\": \"https://example.com/thumb.jpg\"\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/admin/lessons",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "admin", "lessons"]
            },
            "description": "创建或更新课时内容，支持 VIDEO, DOCUMENT, PODCAST, ASSIGNMENT, INTERACTIVE 类型"
          }
        },
        {
          "name": "P0 - 作业列表",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"current\": 1,\n  \"pageSize\": 20,\n  \"courseId\": {{courseId}},\n  \"lessonId\": null,\n  \"status\": \"SUBMITTED\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/admin/assignments",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "admin", "assignments"]
            },
            "description": "分页获取待批改或所有状态的作业列表"
          }
        },
        {
          "name": "P0 - 批改作业",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"score\": 90,\n  \"feedback\": \"完成得很好，继续保持!\",\n  \"rejected\": false\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/admin/assignments/{{assignmentId}}/grade",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "admin", "assignments", "{{assignmentId}}", "grade"]
            },
            "description": "批改作业，设置分数和评语"
          }
        },
        {
          "name": "P1 - 获取上传凭证",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/admin/upload/presigned-url?objectName=courses/video1.mp4&contentType=video/mp4",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "admin", "upload", "presigned-url"],
              "query": [
                {
                  "key": "objectName",
                  "value": "courses/video1.mp4"
                },
                {
                  "key": "contentType",
                  "value": "video/mp4"
                }
              ]
            },
            "description": "获取上传文件的临时凭证，用于直传 OSS"
          }
        },
        {
          "name": "P1 - 查看用户课程",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/admin/users/{{userId}}/courses",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "admin", "users", "{{userId}}", "courses"]
            },
            "description": "查看某位学生拥有的课程及详细进度"
          }
        },
        {
          "name": "P1 - 干预用户课程权限",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"accessStatus\": \"SUSPENDED\",\n  \"validUntil\": null\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/admin/users/{{userId}}/courses/{{courseId}}/access",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "admin", "users", "{{userId}}", "courses", "{{courseId}}", "access"]
            },
            "description": "人工干预学生的课程权限，如封禁或延长有效期"
          }
        }
      ]
    }
  ]
}
